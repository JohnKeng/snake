<pre id=m><script>onkeyup=e=>d=e;l=s=setInterval("m[m[l-s]]=i=0;I*=!m[m[-++s]=p=p+[32,-1,-32,1][d.which&3]&I];m[p]=2;for(h=s;i<I;m.innerHTML=h)h+=['\\n'[i++&31]]+'.o#'[i^(o=p^o?o:s*l++&I)?m[i]|0:1]",o=p=83,I=511)</script>